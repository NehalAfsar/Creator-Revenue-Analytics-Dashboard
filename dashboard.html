<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Creator Analytics Dashboard</title>
    <!-- Tailwind CSS CDN for utility classes -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chart.js CDN for graphs -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.7.1/dist/chart.min.js"></script>
    <!-- Inter font for consistent typography -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <!-- Font Awesome CDN for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        /* Base styles, apply Inter font globally and reset margin/padding */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', sans-serif;
            transition: background-color 0.3s, color 0.3s, border-color 0.3s; /* Smooth transitions for theme changes */
        }

        /* Custom CSS variables for theme colors (Combined from both files, prioritizing Audience.html for base colors) */
        :root {
            /* Light Mode - General (from Audience.html primarily, harmonized) */
            --bg-color: #f8f9fa; /* body background */
            --text-color: #333; /* default text */
            --card-bg: #ffffff;
            --metric-card-bg: #f9fafb;
            --border-color: #eaeaea;
            --btn-primary-bg: #2563eb;
            --positive-color: #10b981;
            --purple: #7e57c2;
            --blue: #42a5f5;
            --teal: #26a69a;
            --orange: #ffa726;
            --pink: #ec407a;
            --dark-blue: #1e3a8a; /* Used for mobile menu toggle bg */

            /* Sidebar colors (from Audience.html) */
            --sidebar-bg: linear-gradient(180deg, #1e3a8a 0%, #0f172a 100%);
            --sidebar-nav-title-color: #93c5fd; /* Light blue for titles */
            --sidebar-active-bg: rgba(96, 165, 250, 0.25); /* blue-300 with opacity */
            --sidebar-active-border: #60a5fa; /* blue-400 */
            --sidebar-hover-bg: rgba(96, 165, 250, 0.15); /* blue-300 with less opacity */

            /* Chart Colors (from original 2.html, harmonized) */
            --chart-text-color: #374151; /* Darker text for charts */
            --chart-grid-color: #e0e0e0;
            --chart-bar-color: #3B82F6;
            --chart-line-color: #10B981;

            /* Tooltip Colors */
            --tooltip-bg-color: #ffffff;
            --tooltip-border-color: #e5e7eb;
            --tooltip-label-color: #6b7280;
            --tooltip-item-color: #1f2937;

            /* Theme Toggle specific for moon/sun */
            --theme-toggle-color: #4b5563; /* Icon color in light mode */
        }

        /* Dark Mode overrides (using data-theme attribute) */
        [data-theme="dark"] {
            /* Dark Mode - General (from Audience.html primarily, harmonized) */
            --bg-color: #121826;
            --text-color: #e0e0e0;
            --card-bg: #1a2439;
            --metric-card-bg: #1e2a47;
            --border-color: #2a3a5a;
            --btn-primary-bg: #3d75e6;
            --positive-color: #10b981; /* Keep same positive color */
            --purple: #7e57c2; /* Keep same purple */
            --blue: #42a5f5; /* Keep same blue */
            --teal: #26a69a; /* Keep same teal */
            --orange: #ffa726; /* Keep same orange */
            --pink: #ec407a; /* Keep same pink */
            --dark-blue: #0f172a; /* Darker for mobile menu toggle */

            /* Dark Mode - Sidebar (from Audience.html) */
            --sidebar-bg: linear-gradient(180deg, #0f1e3f 0%, #070d1c 100%);
            --sidebar-nav-title-color: #60a5fa; /* A bit brighter blue for titles */
            --sidebar-active-bg: rgba(96, 165, 250, 0.2); /* blue-400 with opacity */
            --sidebar-active-border: #60a5fa; /* blue-400 */
            --sidebar-hover-bg: rgba(96, 165, 250, 0.1); /* blue-400 with less opacity */

            /* Chart Colors for Dark Mode */
            --chart-text-color: #e0e0e0;
            --chart-grid-color: #4b5563;
            --chart-bar-color: #60A5FA; /* blue-400 */
            --chart-line-color: #34D399; /* emerald-400 */

            /* Tooltip Colors for Dark Mode */
            --tooltip-bg-color: #374151;
            --tooltip-border-color: #4b5563;
            --tooltip-label-color: #9ca3af;
            --tooltip-item-color: #d1d5db;

            /* Theme Toggle specific for moon/sun */
            --theme-toggle-color: #d1d5db; /* Icon color in dark mode */
        }

        /* General body styling */
        body {
            display: flex;
            height: 100vh;
            background-color: var(--bg-color); /* Use --bg-color */
            color: var(--text-color); /* Use --text-color */
            overflow-x: hidden;
        }

        /* Mobile menu toggle */
        .mobile-menu-toggle {
            position: fixed;
            top: 20px;
            left: 20px;
            background: var(--dark-blue);
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 1001;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            display: none; /* Hidden by default, shown in media queries */
        }
        
        /* Sidebar styling (Copied from Audience.html with adjustments) */
        .sidebar {
            width: 250px;
            background: var(--sidebar-bg);
            color: white;
            padding: 25px 0;
            height: 100vh;
            position: fixed; 
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            transition: transform 0.3s ease;
        }
        
        .logo-container {
            padding: 0 25px 25px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .logo {
            font-size: 24px;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .logo i {
            color: #60a5fa;
        }
        
        .nav-title {
            text-transform: uppercase;
            font-size: 14px;
            color: var(--sidebar-nav-title-color); /* Use variable */
            padding: 25px 25px 10px;
            letter-spacing: 1px;
        }
        
        .nav-links {
            padding: 10px 0;
        }
        
        .nav-item {
            padding: 12px 25px;
            display: flex;
            align-items: center;
            gap: 15px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        a{
            text-decoration: none !important;
        }
        .nav-item-link {
            text-decoration: none;
            color: inherit;
            display: block;
        }
        
        .nav-item:hover {
            background: var(--sidebar-hover-bg); /* Use variable */
        }
        
        .nav-item.active {
            background: var(--sidebar-active-bg); /* Use variable */
            border-left: 4px solid var(--sidebar-active-border); /* Use variable */
        }
        
        .nav-item i {
            width: 24px;
            text-align: center;
        }
        
        /* Main content area */
        .main-content {
            flex: 1;
            margin-left: 250px; /* Adjusted to 250px to match sidebar width */
            padding: 30px; 
            overflow-y: auto;
            transition: margin-left 0.3s ease; /* Transition for sidebar shift */
        }

        /* Dashboard header */
        .dashboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        .dashboard-header h1 {
            font-size: 2rem;
            font-weight: 700;
            color: var(--text-color); /* Use global text color */
        }
        .dashboard-header p {
            font-size: 0.9rem;
            color: var(--text-color); /* Use global text color */
            opacity: 0.8;
        }

        /* Metric cards grid */
        .cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        .card {
            background: var(--card-bg); /* Use global card background */
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            transition: background 0.3s, color 0.3s;
            color: var(--text-color); /* Ensure text color changes with theme */
        }
        .card strong {
            font-size: 1.5rem;
            color: var(--text-color); /* Use global text color */
            display: block;
            margin-top: 5px;
        }
        .card span.detail {
            font-size: 0.8rem;
            color: var(--text-color); /* Use global text color */
            opacity: 0.7;
        }
        .card .progress-bar {
            background-color: var(--border-color); /* Use global border color for progress bar bg */
            border-radius: 9999px;
            height: 6px;
            width: 100%;
            margin-top: 8px;
            overflow: hidden;
        }
        .card .progress-fill {
            height: 100%;
            border-radius: 9999px;
            transition: width 0.3s ease-in-out;
        }
        .card .green-fill { background-color: var(--positive-color); } /* Use positive color */
        .card .blue-fill { background-color: var(--btn-primary-bg); } /* Use primary button background */

        /* Section containers (for charts and other content) */
        .section {
            background: var(--card-bg); /* Use global card background */
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 12px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            transition: background 0.3s, color 0.3s;
        }
        .section h3 {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 15px;
            color: var(--text-color); /* Use global text color */
        }
        .section p {
            color: var(--text-color); /* Use global text color */
            opacity: 0.8;
            margin-bottom: 10px;
        }
        .section strong {
            color: var(--text-color); /* Use global text color */
        }

        /* Horizontal bars for Top Performing Content */
        .horizontal-bar-chart .bar-item {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
            color: var(--text-color);
            opacity: 0.7;
        }
        .horizontal-bar-chart .bar-label {
            width: 100px;
            flex-shrink: 0;
            font-size: 0.9rem;
        }
        .horizontal-bar-chart .bar-container {
            flex-grow: 1;
            height: 10px;
            background-color: var(--border-color); /* Use global border color */
            border-radius: 5px;
            margin-left: 10px;
        }
        .horizontal-bar-chart .bar-fill {
            height: 100%;
            background-color: var(--blue); /* Use blue accent color */
            border-radius: 5px;
            transition: width 0.3s ease-in-out;
        }

        /* Revenue section layout */
        .revenue-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        /* Live view box styling */
        .live-view-box {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            background: var(--card-bg); /* Use global card background */
            border-radius: 12px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        .live-view-box img {
            height: 80px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            object-fit: cover;
        }
        .live-view-box h3 {
            margin-bottom: 5px;
        }
        .live-view-box p {
            margin-bottom: 0;
            font-size: 1rem;
        }
        .live-view-box .live-views-count {
            font-weight: 600;
            color: var(--text-color); /* Use global text color */
        }

        /* Chart-specific styles */
        .chart-container {
            height: 250px;
            width: 100%;
        }

        /* Theme Toggle specific styles (from Audience.html) */
        .theme-toggle {
            background-color: transparent;
            color: var(--theme-toggle-color);
            border: none;
            border-radius: 9999px;
            padding: 8px 12px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
            transition: background-color 0.3s, color 0.3s;
            box-shadow: none;
        }

        .theme-toggle:hover {
            opacity: 0.8;
        }

        .theme-toggle .fa-sun,
        .theme-toggle .fa-moon {
            width: 20px;
            text-align: center;
        }

        /* Initial state: Sun visible, Moon hidden */
        .theme-toggle .fa-sun { display: inline-block; }
        .theme-toggle .fa-moon { display: none; }

        /* Dark theme: Moon visible, Sun hidden */
        [data-theme="dark"] .theme-toggle .fa-sun { display: none; }
        [data-theme="dark"] .theme-toggle .fa-moon { display: inline-block; }


        /* Mobile Specific Styles (from Audience.html) */
        .sidebar-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            z-index: 999;
            display: none;
        }

        @media (max-width: 768px) {
            .mobile-menu-toggle {
                display: flex;
            }
            
            .sidebar {
                transform: translateX(-100%);
            }
            
            .sidebar.active {
                transform: translateX(0);
            }
            
            .main-content {
                margin-left: 0; /* Remove margin when sidebar is hidden on mobile */
                padding-top: 60px; /* Adjust padding to make space for mobile toggle */
            }
            
            .sidebar-overlay.active {
                display: block;
            }
            
            .dashboard-header h1 {
                margin-left: 50px; /* Shift heading to the right to clear mobile toggle */
            }
        }

        @media (max-width: 400px) {
            .main-content {
                padding: 20px 10px;
            }
            
            .dashboard-header h1 {
                font-size: 24px;
            }
            
            .dashboard-header p {
                font-size: 14px;
            }
            
            .card {
                padding: 15px;
            }
        }
        
        /* Hamburger animation */
        .mobile-menu-toggle .fa-bars,
        .mobile-menu-toggle .fa-times {
            transition: transform 0.3s ease;
        }

        /* Chart.js tooltip override to use CSS variables */
        .chartjs-tooltip {
            background-color: var(--tooltip-bg-color) !important;
            border: 1px solid var(--tooltip-border-color) !important;
            color: var(--tooltip-item-color) !important;
        }
        .chartjs-tooltip-title {
            color: var(--tooltip-label-color) !important;
        }
        .chartjs-tooltip-body {
            color: var(--tooltip-item-color) !important;
        }
    </style>
</head>
<body>
    <!-- Mobile Menu Toggle -->
    <div class="mobile-menu-toggle" id="mobileMenuToggle">
        <i class="fas fa-bars"></i>
    </div>
    
    <!-- Overlay for mobile menu -->
    <div class="sidebar-overlay" id="sidebarOverlay"></div>
    
    <!-- Sidebar (Copied from Audience.html) -->
    <div class="sidebar" id="sidebar">
        <div class="logo-container">
            <div class="logo">
                <i class="fas fa-chart-line"></i>
                <span>Creator Analytics</span>
            </div>
        </div>
        
        <div class="nav-title">Analytics</div>
        <div class="nav-links">
            <a href="#" class="nav-item-link"> 
                <div class="nav-item active">
                    <i class="fas fa-chart-pie"></i>
                    <span class="nav-text">Dashboard</span>
                </div>
            </a>
            <a href="content.html" class="nav-item-link"> 
                <div class="nav-item">
                    <i class="fas fa-video"></i>
                    <span class="nav-text">Content</span>
                </div>
            </a>
            <a href="earning.html" class="nav-item-link"> 
                <div class="nav-item">
                    <i class="fas fa-wallet"></i>
                    <span class="nav-text">Earnings</span>
                </div>
            </a>
            <a href="Audience.html" class="nav-item-link"> 
                <div class="nav-item">
                    <i class="fas fa-users"></i>
                    <span class="nav-text">Audience</span>
                </div>
            </a>
             <a href="setting.html" class="nav-item-link">
                <div class="nav-item">
                    <i class="fas fa-cog"></i>
                    <span class="nav-text">setting
                        
                    </span>
                </div>
            </a>
        </div>
        
    </div>

    <!-- Main Content -->
    <div class="main-content" id="main-content">
        <div class="dashboard-header">
            <div>
                <h1>Dashboard</h1>
                <p>Welcome back, Sanjana! Here's a snapshot of your performance.</p>
            </div>
            <div class="flex items-center space-x-4">
                <!-- Theme Toggle Button (Moon/Sun) - Adopted from Audience.html -->
                <button id="themeToggle" class="theme-toggle">
                    <i class="fas fa-moon"></i> <!-- Moon icon, JavaScript will toggle to sun -->
                </button>
                <img src="https://i.pravatar.cc/40" alt="avatar" class="rounded-full w-10 h-10 border-2 border-gray-300 dark:border-gray-600" />
            </div>
        </div>

        <div class="cards">
            <div class="card">
                Active Users<br><strong>27<span class="detail">/80</span></strong>
            </div>
            <div class="card">
                Questions Answered<br><strong>3,298</strong>
            </div>
            <div class="card">
                Avg. Session Length<br><strong>2m 34s</strong>
            </div>
            <div class="card">
                Starting Knowledge<br><strong>64%</strong>
                <div class="progress-bar"><div class="progress-fill blue-fill" style="width: 64%;"></div></div>
            </div>
            <div class="card">
                Current Knowledge<br><strong>86%</strong>
                <div class="progress-bar"><div class="progress-fill green-fill" style="width: 86%;"></div></div>
            </div>
            <div class="card">
                Knowledge Gain<br><strong>+34%</strong>
                <div class="progress-bar"><div class="progress-fill green-fill" style="width: 34%;"></div></div>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
            <div class="section">
                <h3>Views Over Time</h3>
                <p><strong>1.2M</strong> (Last 30 Days <span class="text-emerald-500">+10%</span>)</p>
                <div class="chart-container">
                    <canvas id="viewsChart"></canvas>
                </div>
            </div>

            <div class="section">
                <div class="flex justify-between items-center mb-4">
                    <h3>Earnings Overview</h3>
                    <select id="earnings-date-filter" class="text-sm rounded-md border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-gray-100 py-1 px-2 focus:ring-emerald-500 focus:border-emerald-500 transition-all duration-300">
                        <option value="Month">Month</option>
                        <option value="7 Days">7 Days</option>
                        <option value="30 Days">30 Days</option>
                        <option value="90 Days">90 Days</option>
                        <option value="Custom">Custom</option>
                    </select>
                </div>
                <div class="chart-container">
                    <canvas id="earningsChart"></canvas>
                </div>
            </div>
        </div>

        <div class="section">
            <h3>Performance Metrics</h3>
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
                <div class="card !p-4 border border-gray-200 dark:border-gray-700">
                    <!-- Font Awesome Icon for Total Views (Eye) -->
                    <i class="fa-solid fa-eye text-emerald-500 mb-2 text-2xl"></i>
                    <p class="text-sm text-gray-500 dark:text-gray-400">Total Views</p>
                    <p class="text-lg font-bold text-gray-900 dark:text-gray-100">185,664 <span class="text-xs text-emerald-500">+1.6% from last period</span></p>
                </div>
                <div class="card !p-4 border border-gray-200 dark:border-gray-700">
                    <!-- Font Awesome Icon for Total Earnings (Rupee/Dollar Sign) -->
                    <i class="fa-solid fa-wallet text-blue-500 mb-2 text-2xl"></i>
                    <p class="text-sm text-gray-500 dark:text-gray-400">Total Earnings</p>
                    <p class="text-lg font-bold text-gray-900 dark:text-gray-100">₹13,395 <span class="text-xs text-red-500">-2.0% from last period</span></p>
                </div>
                <div class="card !p-4 border border-gray-200 dark:border-gray-700">
                    <!-- Font Awesome Icon for New Followers (User Group) -->
                    <i class="fa-solid fa-user-group text-purple-500 mb-2 text-2xl"></i>
                    <p class="text-sm text-gray-500 dark:text-gray-400">New Followers</p>
                    <p class="text-lg font-bold text-gray-900 dark:text-gray-100">2,454 <span class="text-xs text-emerald-500">+8.5% from last period</span></p>
                </div>
                <div class="card !p-4 border border-gray-200 dark:border-gray-700">
                    <!-- Font Awesome Icon for Avg. Engagement (Heart) -->
                    <i class="fa-solid fa-heart text-red-500 mb-2 text-2xl"></i>
                    <p class="text-sm text-gray-500 dark:text-gray-400">Avg. Engagement</p>
                    <p class="text-lg font-bold text-gray-900 dark:text-gray-100">2.0% <span class="text-xs text-red-500">-0.2% from last period</span></p>
                </div>
            </div>
            <div class="revenue-cards">
                <div class="card">Total Revenue<br><strong>₹<span id="revenue">567.89</span> <span class="text-sm text-emerald-500">+15%</span></strong></div>
                <div class="card">Average RPM<br><strong>₹2.50 <span class="text-sm text-emerald-500">+5%</span></strong></div>
            </div>
        </div>

        <div class="section">
            <h3>Top Performing Content</h3>
            <p>25K (Last 7 Days <span class="text-emerald-500">+8%</span>)</p>
            <div class="chart-container">
                <canvas id="topPerformingContentChart"></canvas>
            </div>
        </div>

        <div class="section live-view-box">
            <div>
                <h3>Real-Time Updates</h3>
                <p>Live Views: <span id="live-views" class="live-views-count">1,231</span> viewers watching your content right now</p>
            </div>
            <img src="https://placehold.co/160x90/4A4F4F/ffffff?text=Konkan%0AA%20cinematic%20Vlog" alt="Live Preview">
        </div>
    </div>

    <script>
        let earningsDateFilter = 'Month'; // Default filter for earnings chart

        // Mock data for charts and metrics
        const mockAnalyticsData = [
            { name: 'Jan', views: 4000, earnings: 2400, followers: 240 },
            { name: 'Feb', views: 3000, earnings: 1398, followers: 221 },
            { name: 'Mar', views: 2000, earnings: 9800, followers: 229 },
            { name: 'Apr', views: 2780, earnings: 3908, followers: 200 },
            { name: 'May', views: 1890, earnings: 4800, followers: 218 },
            { name: 'Jun', views: 2390, earnings: 3800, followers: 250 },
            { name: 'Jul', views: 3490, earnings: 4300, followers: 210 },
            { name: 'Aug', views: 4000, earnings: 5000, followers: 280 },
            { name: 'Sep', views: 3500, earnings: 4500, followers: 260 },
            { name: 'Oct', views: 3800, earnings: 4700, followers: 290 },
            { name: 'Nov', views: 4200, earnings: 5200, followers: 310 },
            { name: 'Dec', views: 4500, earnings: 5500, followers: 330 },
        ];

        const mockEarningsDataByPeriod = {
            'Month': [
                { name: 'Jan', earnings: 2400 }, { name: 'Feb', earnings: 1398 },
                { name: 'Mar', earnings: 9800 }, { name: 'Apr', earnings: 3908 },
                { name: 'May', earnings: 4800 }, { name: 'Jun', earnings: 3800 },
                { name: 'Jul', earnings: 4300 }, { name: 'Aug', earnings: 5000 },
                { name: 'Sep', earnings: 4500 }, { name: 'Oct', earnings: 4700 },
                { name: 'Nov', earnings: 5200 }, { name: 'Dec', earnings: 5500 },
            ],
            '7 Days': [
                { name: 'Day 1', earnings: 300 }, { name: 'Day 2', earnings: 450 },
                { name: 'Day 3', earnings: 600 }, { name: 'Day 4', earnings: 350 },
                { name: 'Day 5', earnings: 700 }, { name: 'Day 6', earnings: 500 },
                { name: 'Day 7', earnings: 800 },
            ],
            '30 Days': [
                { name: 'Week 1', earnings: 1500 }, { name: 'Week 2', earnings: 2200 },
                { name: 'Week 3', earnings: 1800 }, { name: 'Week 4', earnings: 2500 },
            ],
            '90 Days': [
                { name: 'Month 1', earnings: 5000 }, { name: 'Month 2', earnings: 6000 },
                { name: 'Month 3', earnings: 7500 },
            ],
            'Custom': [
                { name: 'Custom 1', earnings: 1000 }, { name: 'Custom 2', earnings: 2000 },
                { name: 'Custom 3', earnings: 3000 }, { name: 'Custom 4', earnings: 4000 },
            ]
        };

        const mockTopContentData = [
            { category: 'Category A', value: 90 },
            { category: 'Category B', value: 75 },
            { category: 'Category C', value: 85 },
            { category: 'Category D', value: 60 },
            { category: 'Category E', value: 70 },
            { category: 'Category F', value: 95 },
            { category: 'Category G', value: 80 },
        ];

        let viewsChart, earningsChart, topPerformingContentChart; // Chart instances

        // Function to initialize (or re-initialize) Chart.js charts
        function initializeCharts() {
            // Destroy existing charts to prevent duplicates and update issues
            if (viewsChart) viewsChart.destroy();
            if (earningsChart) earningsChart.destroy();
            if (topPerformingContentChart) topPerformingContentChart.destroy();

            // Get computed styles for chart colors
            const chartTextColor = getComputedStyle(document.documentElement).getPropertyValue('--chart-text-color').trim();
            const chartGridColor = getComputedStyle(document.documentElement).getPropertyValue('--chart-grid-color').trim();
            const chartBarColor = getComputedStyle(document.documentElement).getPropertyValue('--chart-bar-color').trim();
            const chartLineColor = getComputedStyle(document.documentElement).getPropertyValue('--chart-line-color').trim();
            const chartAccentPurple = getComputedStyle(document.documentElement).getPropertyValue('--purple').trim(); // Use --purple from Audience.html

            // Views Over Time Chart
            const ctxViews = document.getElementById('viewsChart')?.getContext('2d');
            if (ctxViews) {
                viewsChart = new Chart(ctxViews, {
                    type: 'line',
                    data: {
                        labels: mockAnalyticsData.map(d => d.name),
                        datasets: [{
                            label: 'Views',
                            data: mockAnalyticsData.map(d => d.views),
                            backgroundColor: chartLineColor.replace(')', ', 0.2)'), // lighter fill
                            borderColor: chartLineColor,
                            borderWidth: 2,
                            tension: 0.4,
                            pointRadius: 3,
                            pointBackgroundColor: chartLineColor,
                            fill: true // Fill the area under the line
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { display: false },
                            tooltip: { mode: 'index', intersect: false, external: Chart.defaults.plugins.tooltip.external } // Use external tooltip for custom styling
                        },
                        scales: {
                            x: {
                                ticks: { color: chartTextColor },
                                grid: { display: false } // Hide x-grid lines
                            },
                            y: {
                                ticks: { color: chartTextColor, callback: function(value) { return value / 1000 + 'K'; } },
                                grid: { color: chartGridColor }
                            }
                        }
                    }
                });
            }

            // Earnings Overview Chart
            const ctxEarnings = document.getElementById('earningsChart')?.getContext('2d');
            const currentEarningsData = mockEarningsDataByPeriod[earningsDateFilter];
            if (ctxEarnings && currentEarningsData) {
                earningsChart = new Chart(ctxEarnings, {
                    type: 'bar',
                    data: {
                        labels: currentEarningsData.map(d => d.name),
                        datasets: [{
                            label: 'Earnings',
                            data: currentEarningsData.map(d => d.earnings),
                            backgroundColor: chartBarColor,
                            borderRadius: 5
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { display: false },
                            tooltip: { mode: 'index', intersect: false, external: Chart.defaults.plugins.tooltip.external }
                        },
                        scales: {
                            x: {
                                ticks: { color: chartTextColor },
                                grid: { display: false } // Hide x-grid lines
                            },
                            y: {
                                ticks: { color: chartTextColor, callback: function(value) { return '₹' + value / 1000 + 'K'; } }, /* Changed to Rupee */
                                grid: { color: chartGridColor }
                            }
                        }
                    }
                });
            }

            // Top Performing Content Chart (Horizontal Bar Chart)
            const ctxTopContent = document.getElementById('topPerformingContentChart')?.getContext('2d');
            if (ctxTopContent) {
                topPerformingContentChart = new Chart(ctxTopContent, {
                    type: 'bar',
                    data: {
                        labels: mockTopContentData.map(d => d.category),
                        datasets: [{
                            label: 'Performance',
                            data: mockTopContentData.map(d => d.value),
                            backgroundColor: chartAccentPurple, // Use the purple accent color
                            borderRadius: 5,
                        }]
                    },
                    options: {
                        indexAxis: 'y', // Makes it a horizontal bar chart
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { display: false },
                            tooltip: { mode: 'index', intersect: false, external: Chart.defaults.plugins.tooltip.external }
                        },
                        scales: {
                            x: {
                                ticks: { color: chartTextColor, beginAtZero: true },
                                grid: { color: chartGridColor }
                            },
                            y: {
                                ticks: { color: chartTextColor },
                                grid: { display: false } // Hide y-grid lines for horizontal bars
                            }
                        }
                    }
                });
            }
        }

        // Function to handle theme toggling (Updated for moon/sun icons)
        function setTheme(isDark) {
            if (isDark) {
                document.documentElement.setAttribute('data-theme', 'dark');
            } else {
                document.documentElement.setAttribute('data-theme', 'light');
            }
            localStorage.setItem('theme', document.documentElement.getAttribute('data-theme')); // Save theme preference
            initializeCharts(); // Re-render charts with new theme colors
        }

        // Function to setup all event listeners after content is rendered
        function setupEventListeners() {
            // Mobile sidebar toggle
            const mobileMenuToggle = document.getElementById('mobileMenuToggle');
            const sidebar = document.getElementById('sidebar');
            const sidebarOverlay = document.getElementById('sidebarOverlay');
            // const menuIcon = document.getElementById('menu-icon'); // Not in this HTML directly
            // const xIcon = document.getElementById('x-icon'); // Not in this HTML directly

            const toggleSidebar = () => { /* Renamed for consistency with Audience.html */
                sidebar.classList.toggle('active');
                sidebarOverlay.classList.toggle('active');
                
                // Update hamburger icon (assuming fas fa-bars and fas fa-times toggle on the same element)
                const icon = mobileMenuToggle.querySelector('i');
                if (sidebar.classList.contains('active')) {
                    icon.classList.remove('fa-bars');
                    icon.classList.add('fa-times');
                } else {
                    icon.classList.remove('fa-times');
                    icon.classList.add('fa-bars');
                }
            };

            if (mobileMenuToggle) mobileMenuToggle.addEventListener('click', toggleSidebar);
            if (sidebarOverlay) sidebarOverlay.addEventListener('click', toggleSidebar);

            // Theme toggle button (moon/sun)
            const themeToggle = document.getElementById('themeToggle'); /* Changed id to themeToggle */
            if (themeToggle) {
                themeToggle.addEventListener('click', () => {
                    // Toggle theme based on current state of document.documentElement
                    setTheme(document.documentElement.getAttribute('data-theme') !== 'dark');
                });
            }

            // Set initial theme from localStorage
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme) {
                document.documentElement.setAttribute('data-theme', savedTheme);
            } else {
                // Default to light if no theme is saved
                document.documentElement.setAttribute('data-theme', 'light');
            }
            // Initial call to set theme (and icons will automatically adjust via CSS)
            setTheme(document.documentElement.getAttribute('data-theme') === 'dark');


            // Earnings filter dropdown
            const earningsFilter = document.getElementById('earnings-date-filter');
            if (earningsFilter) {
                earningsFilter.value = earningsDateFilter; // Set initial value
                earningsFilter.addEventListener('change', (e) => {
                    earningsDateFilter = e.target.value;
                    initializeCharts(); // Re-initialize earnings chart with new data
                });
            }

            // Sidebar navigation links
            document.querySelectorAll('.sidebar .nav-item').forEach(button => {
                button.addEventListener('click', function(e) {
                    // e.preventDefault(); // Prevent default link behavior, handled by <a> tags now
                    // Remove 'active' from all links
                    document.querySelectorAll('.sidebar .nav-item').forEach(nav => nav.classList.remove('active'));
                    // Add 'active' to the clicked link
                    this.classList.add('active');

                    // Close mobile sidebar if open
                    if (sidebar.classList.contains('active')) {
                        toggleSidebar(); /* Call toggleSidebar, not toggleMobileSidebar */
                    }
                });
            });

            // Handle window resize for sidebar
            function handleResize() {
                if (window.innerWidth > 768) {
                    sidebar.classList.remove('active');
                    sidebarOverlay.classList.remove('active');
                    // Ensure the menu icon is bars when desktop view
                    mobileMenuToggle.querySelector('i').classList.remove('fa-times');
                    mobileMenuToggle.querySelector('i').classList.add('fa-bars');
                }
            }
            window.addEventListener('resize', handleResize);


            // Simulated real-time live views update
            setInterval(() => {
                const liveViewsElement = document.getElementById('live-views');
                if (liveViewsElement) {
                    const newViews = Math.floor(1000 + Math.random() * 1000);
                    liveViewsElement.textContent = newViews.toLocaleString();
                }
            }, 4000); // Update every 4 seconds
        }

        // Initial setup on window load
        window.onload = () => {
            setupEventListeners(); // Set up all event listeners, including theme initialization
            initializeCharts(); // Draw charts initially
        };

        // Resize observer for chart responsiveness
        const resizeObserver = new ResizeObserver(() => {
            initializeCharts();
        });

        // Observe the main content area for resizes
        window.addEventListener('load', () => {
            const mainContent = document.getElementById('main-content');
            if (mainContent) {
                resizeObserver.observe(mainContent);
            }
        });
    </script>
</body>
</html>
